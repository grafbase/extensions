syntax = "proto3";

import "grafbase/options.proto";

package test.composite;

service OrderService {
  rpc GetOrder(GetOrderRequest) returns (Order);
}

// Test message-level composite schema entity with composite key
message Order {
  option (grafbase.graphql.derive) = {
    entity: "CustomerAddress",
    field: "delivery_address",
    is: "{ customerId: customer_id addressId: address_id }"
  };

  string id = 1;
  string description = 2;
  // Composite key reference to CustomerAddress entity
  string customer_id = 3;
  string address_id = 4;
}

// Test message-level composite schema entity with single key
message Product {
  option (grafbase.graphql.derive) = {
    entity: "User",
    field: "owner",
    is: "{ id: user_id }"
  };

  string id = 1;
  string name = 2;
  string user_id = 3;
}

message GetOrderRequest {
  string id = 1;
}
